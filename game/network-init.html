<html>

<body style="text-align: center;">
  <h1>Start A Connection</h1>
  <textarea id="inp-connection-string" type="text" style="width: 800px;height: 400px;">

  </textarea>
  <br/><br/>
  <button id="btn-go">Connect</button>
</body>

<script>
  // Receive Message Headers
  const SENDOP_CONFIG_CHANGED = 'pekoconn-config-changed';

  // Send Message Headers
  const RECVOP_CONFIG_REQUEST = 'pekoconn-config-request';

  let channel = new BroadcastChannel('pekoland-data');

  document.addEventListener('DOMContentLoaded', () => {
    let connString;

    document.getElementById('btn-go').addEventListener('click', () => {
      connString = document.getElementById('inp-connection-string').value;

      window.open('network.html', '_blank');
    });

    channel.onmessage = (evt) => {
      if (!evt.data || !evt.data.op) return;
      let data = evt.data;

      if (data.op === RECVOP_CONFIG_REQUEST) {
        channel.postMessage({
          op: SENDOP_CONFIG_CHANGED,
          partnerString: connString
        });
      }
    }
  });
</script>
</html>